# ChartsBuilder
# Постановка задачи

Предложен начальный вариант архитектуры ПО, в которую требуется внести изменения с целью снижения связности архитектуры. Используется принцип внедрения зависимости. Реализация внедрения зависимости с помощью IOC контейнера.
При разработке архитектуры учесть:
Возможность добавления новых графиков (графики отличаются видом и данными
Изменение визуального стиля графиков (цветной, черно белый).

Общие требования к GUI:
Загружаем данные, путем выбора нужного файла. Данные в ПО не отображаем, отображаем только график, построенный относительно считанных данных.
При печати в pdf выбираем место сохранения графика.


# Решение.
### 1) Анализ входных данных. 
  Изначально имеем список файлов формата SQLite. Было решено использовать эти файлы, а файлы форматов CSV и JSON получить из них же с помощью программы DB Browser for SQLite путем экспорта. Будем предполагать, что "ключи" входных данных имеют названия "Time" и "Value" соответственно для всех типов файлов.
  
### 2) Суть. 
  Необходимо создать приложение для рисования графиков на основе данных полученных из файлов. Пользователь будет выбирать папку, в которой хранятся необходимые файлы. Список файлов будет отображаться на основном окне приложения. При выборе файла из списка программа сразу будет выдавать график, с учетом того, какой тип диаграммы выбран. У пользователя есть возможность сделать полученную диаграмму черно-белой, а так же изменить тип диаграммы, что приведет к её перерисовке. Дополнительно у пользователя есть опция "Сохранить график", которая будет сохранять созданную диаграмму в формате .pdf в то место, которое пользователь выберет. Данная опция доступна только в том случае, если график удалось сгенерировать.
   
### 3) Реализация.
  Для реализации поставленной задачи выделим следующие классы:  
  ##### Классы стратегий получения данных
  Для получения данных предлагается использование паттерна Стратегия - поведенческий паттерн проектирования, позволяющий определять семейства алгоритмов, инкапсулировать их и сделать взаимозаменяемыми.
  ###### class IDataGetterStrategy
  Интерфейс стратегий, содержащий в себе чисто абстрактные функции: проверка файла и получение данных
  ###### class SQLiteDataGetterStrategy
  Конкретная реализация под файлы формата SQLite. 
  ###### class JSONDataGetterStrategy
  Конкретная реализация под файлы формата JSON.
  ###### class CSVDataGetterStrategy
  Конкретная реализация под файлы формата CSV.
  ##### Шаблонный метод для рисования
  Для отрисовки графиков был выбран Шаблонный метод - поведенческий шаблон проектирования, определяющий основу алгоритма и позволяющий наследникам переопределять некоторые шаги алгоритма, не изменяя его структуру в целом. 
  Алгоритм был выбран следующий:
  1) Очистить старый график
  2) Приготовить данные для их отображения на графике
  3) Дополнительно настроить график (анимация, установка названия графика и т.д.)
  4) Вывести график на экран
  ###### class ChartDrawer
  Определяет общий алгоритм рисования и две функции, которые обязаны быть определены наследниками: подготовка данных и настройка графика.
  ###### class BarChartDrawer
  Реализует функции подготовки данных и настройки графика.
  Для столбчатых диаграмм подготовка данных происходит по принципу группировки входных данных по значению "год-месяц", где значение соответствующее дате определяется как среднее.
  ###### class PieChartDrawer
  Реализует функции подготовки данных и настройки графика.
  Для круговых диаграмм берутся только первые 10 значений из входных данных.
  ##### Принцип внедрения зависимостей
  Для перенесения ответственности за создание и управление зависимостями между объектами будем пользоваться готовой реалзиацией IoC_container.
  ###### class IOCContainer
  Готовая реализация IoC_контейнера, с помощью которой будем регистрировать стратегии взятия данных и варианты использования шаблона рисования для того, чтобы передать ему ответсвтвенность за создание данных объектов и устранить лишние зависимости.
  ##### Основное окно приложения
  ![image](https://github.com/Romkagai/ChartsBuilder/assets/106104315/2ab41427-a7dd-43d4-b13f-f796c0c55d83)
  1) "Открыть" - открывает QTreeView со всеми папками
  2) "Выбор типа диаграммы" - позволяет менять тип диаграммы между столбчатой и круговой
  3) "Черно-белый" - позволяет изменить цвет графика на оттенки серого
  4) "Сохранить график" - позволяет сохранить полученный график в формате pdf.
  ###### class MainWindow
  В данном классе:
  1) Хранятся взятые данные и путь к текущему файлу
  2) Определяются все элементы окна - кнопки, лейблы, комбо-боксы, отображение графика, дерево и список файлов.
  3) Используется IoC_container.
  Функционал:
  1) Является классом-контекстом, использующим стратегии взятия данных.
  2) Компонует основное окно приложения в конструкторе, в нем же устанавливает сигнально-слотовые соединения
  3) Определяет все слоты для обработки сигналов:
     3.1) Выбор папки в treeView - изменит состояние listView и установит в него путь. Поменяет статус-бар.
     3.2) Выбор файла в listView - Поменяет статус-бар. Проверит расширение выбранного файла. Установит стратегию взятия данных. Проверит файл с учетом входных данных. С учетом выбора типа диаграммы зарегистрирует в контейнере объект рисования и выведет график. Разрешит печать. В ином случае отобразит факт того, что файл некорректен.
     3.3) Установка галочки в CheckBox - применит эффект к графику.
     3.4) Нажатие кнопки "Открыть" - выведет на экран QTreeView для выбора необходимой папки.
     3.5) Нажатие кнопки "Печать" - откроет QFileDialog для выбора папки для сохранения полученного графика.
     3.6) Изменение типа диаграммы - отрисует диаграмму с учетом выбранного типа.
  4) Дополнительно "переопределяет" closeEvent для корректного закрытия treeView. Если он будет открыт перед тем, как закроется главное окно, то это приведет к ошибке. Предварительно закрываем окно.
  P.S. Повсеместно используются умные указатели для контроля памяти.
     
  
  
### UML-диаграмма проекта
![ChartsBuilderUML](https://github.com/Romkagai/ChartsBuilder/assets/106104315/18bb74ed-8e10-4204-8ba1-f9ad6506d3a4)


    

